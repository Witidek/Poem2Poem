(dp1
S'output'
p2
S"<class 'sqlite3.OperationalError'> no such table: rating"
p3
sS'layer'
p4
S'C:\\Users\\Kevin\\Desktop\\web2py\\applications\\P2P\\controllers/default.py'
p5
sS'code'
p6
S'# -*- coding: utf-8 -*-\n# this file is released under public domain and you can use without limitations\n\n#########################################################################\n## This is a sample controller\n## - index is the default action of any application\n## - user is required for authentication and authorization\n## - download is for downloading files uploaded in the db (does streaming)\n#########################################################################\nimport datetime\n\ndef index():\n    return locals()\n\ndef user():\n    return dict(form=auth())\n\ndef browse():\n    rows = db(db.poem).select()\n    return locals()\n\ndef search():\n    rows = db(db.poem).select()\n    searchKey = ""\n    searchType = \'Poems\'\n    form = FORM(\'Search: \',\n              INPUT(_name=\'search\'),\n              \'    Search By:  \',\n              INPUT(_type =\'radio\', _name = \'searchType\', _value = \'Poems\', _checked="checked"), \'  Poems \',\n              INPUT(_type =\'radio\', _name = \'searchType\', _value = \'Authors\'),\'  Authors  \',\n              INPUT(_type=\'submit\'))\n    if form.accepts(request,session):\n        searchKey = form.vars.search\n        searchType = form.vars.searchType\n\n    return locals()\n@auth.requires_login()\ndef poem():\n    # Redirect to poem browser if no argument for poem id\n    if not request.args(0): redirect(URL(\'browse\'))\n\n    # Load poem using the URL argument as poem id\n    poem = db.poem(request.args(0,cast=int))\n    rating = db(db.rating.poem_id == poem.id).select()\n    # Displaying ABAB\n    if (poem.category == \'16 line ABAB rhyme\') or (poem.category == \'16 line AABB rhyme\') or (poem.category == \'Sonnet\') or (poem.category == \'Limerick\') or (poem.category == \'AAAA\'):\n        abab = db(db.abab.poem_id == poem.id).select().first()\n        lines = db(db.new_line.poem_id == poem.id).select(orderby=db.new_line.line_number)\n        contributors = db(db.new_line.poem_id == poem.id).select(db.new_line.author, groupby=db.new_line.author)\n    # Displaying Haiku\n    elif (poem.category == \'Haiku\') or (poem.category == \'10 line Syllabic Verse\') :\n        haiku = db(db.haiku.poem_id == poem.id).select().first()\n        words = db(db.new_word.poem_id == poem.id).select(orderby=db.new_word.word_number)\n        contributors = db(db.new_word.poem_id == poem.id).select(db.new_word.author, groupby=db.new_word.author)\n    elif poem.category == \'Acrostic\':\n        acrostic = db(db.acrostic.poem_id == poem.id).select().first()\n        lines = db(db.new_line.poem_id == poem.id).select(orderby=db.new_line.line_number)\n        contributors = db(db.new_line.poem_id == poem.id).select(db.new_line.author, groupby=db.new_line.author)\n    return locals()\n\ndef count_syllables(str):\n    import urllib\n    import urllib2\n    from gluon.contrib import simplejson\n\n    # GET JSONP from RhymeBrain API and parse\n    url = \'http://rhymebrain.com/talk\'\n    data = {}\n    data[\'function\'] = \'getWordInfo\'\n    data[\'word\'] = str\n    url_values = urllib.urlencode(data)\n    full_url = url + \'?\' + url_values\n    data = urllib2.urlopen(full_url)\n    result = data.read()\n    parsed_json = simplejson.loads(result)\n\n    # Return number of syllables cast as int\n    return int(parsed_json[\'syllables\'])\n\ndef upVoteFunny():\n    poem = db.poem(request.args(0,cast=int))\n    db.rating.insert(poem_id = poem.id, voteFunny = 1)\n    redirect(URL(\'poem\',args = [request.args(0)]))\n    return locals()\n\ndef unVoteFunny():\n    poem = db.poem(request.args(0,cast=int))\n    db((db.rating.author == auth.user) and (db.rating.poem_id == poem.id) and (db.rating.voteFunny == 1)).delete()\n    redirect(URL(\'poem\',args = [request.args(0)]))\n    return locals()\n\ndef upVoteInteresting():\n    poem = db.poem(request.args(0,cast=int))\n    db.rating.insert(poem_id = poem.id, voteInteresting = 1)\n    redirect(URL(\'poem\',args = [request.args(0)]))\n    return locals()\n\ndef unVoteInteresting():\n    poem = db.poem(request.args(0,cast=int))\n    db((db.rating.author == auth.user) and (db.rating.poem_id == poem.id) and (db.rating.voteInteresting == 1)).delete()\n    redirect(URL(\'poem\',args = [request.args(0)]))\n    return locals()\n\ndef upVoteCool():\n    poem = db.poem(request.args(0,cast=int))\n    db.rating.insert(poem_id = poem.id, voteCool = 1)\n    redirect(URL(\'poem\',args = [request.args(0)]))\n    return locals()\n\ndef unVoteCool():\n    poem = db.poem(request.args(0,cast=int))\n    db((db.rating.author == auth.user) and (db.rating.poem_id == poem.id) and (db.rating.voteCool == 1)).delete()\n    redirect(URL(\'poem\',args = [request.args(0)]))\n    return locals()\n\n@auth.requires_login()\ndef create():\n    # Redirect to poem browser if no argument for poem type\n    if not request.args(0): redirect(URL(\'browse\'))\n\n    # Create form for 16 line ABAB rhyme\n    if (request.args(0) == \'abab\') or (request.args(0) == \'aabb\') or (request.args(0) == \'sonnet\') or (request.args(0) == \'limerick\') or (request.args(0) == \'aaaa\'):\n        form = SQLFORM.factory(db.poem, db.abab, fields=[\'title\', \'description\', \'body\', \'permission\']).process()\n        if request.args(0) == \'aabb\': form.vars.category = \'16 line AABB rhyme\'\n        elif request.args(0) == \'sonnet\': form.vars.category = \'Sonnet\'\n        elif request.args(0) == \'limerick\': form.vars.category = \'Limerick\'\n        elif request.args(0) == \'aaaa\' : form.vars.category = \'AAAA\'\n        if form.accepted:\n            # Do an insert if ABAB\n            id = db.poem.insert(**db.poem._filter_fields(form.vars))\n            db.abab.insert(poem_id = db.poem(id), body = form.vars.body)\n            # Create new mutex for this poem\n            db.mutex.insert(poem_id = id, editing = False, edit_timestamp = request.now, ping_timestamp = request.now)\n            # Create a new insert into permission table if poem was created Private (give owner permission)\n            if form.vars.permission == \'Private\':\n                db.permission.insert(user_id = auth.user, poem_id = id)\n            redirect(URL(\'poem\', args=id))\n    # Create form for haiku\n    elif (request.args(0) == \'haiku\') or (request.args(0) == \'syllabic\'):\n        if request.args(0) == \'haiku\':\n            form = SQLFORM.factory(db.poem, db.haiku, fields=[\'title\', \'description\', \'start_haiku\', \'permission\'],labels = {\'start_haiku\':\'Starting Words\'}).process(onvalidation = create_haiku_check)\n            form.vars.category = \'Haiku\'\n    #########################################\n    #REMEMBER TO CHANGE THE START HAIKU TEXT\n    #########################################\n        elif request.args(0) == \'syllabic\':\n            form = SQLFORM.factory(db.poem, db.haiku, fields=[\'title\', \'description\', \'start_haiku\', \'permission\'],labels = {\'start_haiku\':\'Starting Word\'}).process(onvalidation = create_syllabic_check)\n            form.vars.category = \'10 line Syllabic Verse\'\n        if form.accepted:\n            word_list = str(form.vars.start_haiku).split(\' \')\n            word_count = len(word_list)\n            syllable_count = 0\n            for word in word_list:\n                syllable_count += count_syllables(word)\n\n            id = db.poem.insert(**db.poem._filter_fields(form.vars))\n            db.haiku.insert(poem_id = id, start_haiku = form.vars.start_haiku, word_count = word_count, syllable_count = syllable_count, body_syllable_count = syllable_count)\n\n            # Create new mutex for this poem\n            db.mutex.insert(poem_id = id, editing = False, edit_timestamp = request.now, ping_timestamp = request.now)\n\n            # Create a new insert into permission table if poem was created Private (give owner permission)\n            if form.vars.permission == \'Private\':\n                db.permission.insert(user_id = auth.user, poem_id = form.vars.id)\n            redirect(URL(\'poem\', args=id))\n    elif request.args(0) == \'acrostic\':\n        form = SQLFORM.factory(db.poem, db.acrostic, fields=[\'title\', \'description\', \'word\', \'permission\']).process()\n        form.vars.category = \'Acrostic\'\n        if form.accepted:\n            # Do an insert if Acrostic\n            id = db.poem.insert(**db.poem._filter_fields(form.vars))\n            db.acrostic.insert(poem_id = db.poem(id), word = form.vars.word)\n\n            # Create new mutex for this poem\n            db.mutex.insert(poem_id = id, editing = False, edit_timestamp = request.now, ping_timestamp = request.now)\n            # Create a new insert into permission table if poem was created Private (give owner permission)\n            if form.vars.permission == \'Private\':\n                db.permission.insert(user_id = auth.user, poem_id = id)\n            redirect(URL(\'poem\', args=id))\n    else:\n        redirect(URL(\'browse\'))\n    return locals()\n\ndef create_haiku_check (form):\n\n    word_list = str(form.vars.start_haiku).split(\' \')\n    word_count = len(word_list)\n    syllable_count = 0\n    for word in word_list:\n        syllable_count += count_syllables(word)\n        if syllable_count > 5:\n            form.errors.start_haiku = \'Too many Syllables (5 Max)\'\n\ndef create_syllabic_check (form):\n    word_list = str(form.vars.start_haiku).split(\' \')\n    word_count = len(word_list)\n    syllable_count = 0\n    for word in word_list:\n        syllable_count += count_syllables(word)\n        if syllable_count > 1:\n            form.errors.start_haiku = \'Too many Syllables (1 Max)\'\n\n@auth.requires_login()\ndef edit():\n    # Redirect to poem browser if no argument for poem id\n    if not request.args(0): redirect(URL(\'browse\'))\n\n    # Load poem using the URL argument as poem id\n    poem_id = request.args(0,cast=int)\n    poem = db.poem(poem_id)\n\n    # Displaying ABAB\n    if (poem.category == \'16 line ABAB rhyme\') or (poem.category == \'16 line AABB rhyme\') or (poem.category == \'Sonnet\'):\n        abab = db(db.abab.poem_id == poem.id).select().first()\n        lines = db(db.new_line.poem_id == poem.id).select(orderby=db.new_line.line_number)\n        contributors = db(db.new_line.poem_id == poem.id).select(db.new_line.author, groupby=db.new_line.author)\n    # Displaying Haiku\n    elif poem.category == \'Haiku\':\n        haiku = db(db.haiku.poem_id == poem.id).select().first()\n        words = db(db.new_word.poem_id == poem.id).select(orderby=db.new_word.word_number)\n        contributors = db(db.new_word.poem_id == poem.id).select(db.new_word.author, groupby=db.new_word.author)\n\n    # Redirect if current user is not owner of poem\n    if poem.author != auth.user.id:\n        session.flash = \'You are not the owner of this poem and cannot edit it\'\n        redirect(URL(\'poem\',args=poem.id))\n\n    # Create SQLFORM\n    form = SQLFORM(db.poem, record=poem, fields=[\'title\',\'description\']).process()\n    if (poem.category == \'16 line ABAB rhyme\') or (poem.category == \'16 line AABB rhyme\') or (poem.category == \'Sonnet\') or (poem.category == \'Limerick\') or (poem.category == \'aaaa\'):\n        lines = db(db.new_line.poem_id == poem_id).select(orderby=db.new_line.line_number)\n        lines_form = []\n        line_form = []\n        for line in lines:\n            delete_form = FORM(INPUT(_name="line_id", _type=\'hidden\',value=line.id), INPUT(_type=\'submit\', _value = \'Delete\')).process(onvalidation=delete_line)\n            delete_form.vars.line = line.line\n            lines_form.append(delete_form)\n            print line.id\n            line_form.append(line.line)\n    elif poem.category == \'Haiku\':\n        word = db(db.new_word.poem_id == poem_id).select(orderby=db.new_word.word_number)\n        words_form = []\n        word_form = []\n        for word in words:\n            delete_word_form = FORM(INPUT(_name="word_id", _type=\'hidden\',value=word.id), INPUT(_type=\'submit\', _value = \'Delete\')).process(onvalidation=delete_word, next=URL(\'edit\', args=poem.id))\n            delete_word_form.vars.word = word.word\n            words_form.append(delete_word_form)\n            word_form.append(word.word)\n\n    if form.accepted: redirect(URL(\'browse\'))\n    forms = FORM(\'Username: \',\n              INPUT(_name=\'username\'),\n              INPUT(_type=\'submit\'))\n    if forms.accepts(request,session):\n        added = False\n        for users in db(db.auth_user).select():\n            if(users.username == forms.vars.username):\n                for permission in db(db.permission).select():\n                    if(permission.user_id == users.id and permission.poem_id == poem.id):\n                        response.flash = \'Already Added\'\n                    else:\n                        added = True\n                if(added == True):\n                    db.permission.insert(user_id = users.id , poem_id = poem.id)\n                    response.flash = \'Added\'\n    return locals()\n\ndef delete_line(form):\n    print \'deleting\' + form.vars.line_id\n    row = db(db.new_line.id == form.vars.line_id).select().first()\n    row.update_record(line = \'\')\n\ndef delete_word(form):\n    print form.vars.word_id\n    word = db(db.new_word.id == form.vars.word_id).select().first()\n    word.update_record(word = \'\')\n\n@auth.requires_login()\ndef add_check():\n    # Redirect to poem browser if no argument for poem id\n    if not request.args(0): redirect(URL(\'browse\'))\n    poem_id = request.args(0,cast=int)\n    poem = db.poem(poem_id)\n    mutex = db(db.mutex.poem_id == poem_id).select().first()\n\n    # Check if poem is private and if current user has proper permissions, redirect if no permission\n    if poem.permission == \'Private\':\n        print \'private\'\n        print db(db.permission.poem_id == poem.id).select().first().user_id\n        print auth.user.id\n        if not db((db.permission.poem_id == poem.id) & (db.permission.user_id == auth.user_id)).select():\n            session.flash = \'You do not have permission to add to this poem\'\n            redirect(URL(\'poem\', args=poem.id))\n\n    # Check and redirect if another user is currently trying to add a line for this poem\n    if mutex.editing:\n        edit_timestamp = mutex.edit_timestamp\n        minutes_elapsed = (datetime.datetime.now() - edit_timestamp).total_seconds() / 60\n        if minutes_elapsed < 5.0:\n            ping_timestamp = mutex.ping_timestamp\n            seconds_elapsed = (datetime.datetime.now() - ping_timestamp).total_seconds()\n            if seconds_elapsed <= 30.0:\n                session.flash = \'A user is currently adding a line!\'\n                redirect(URL(\'poem\', args=poem_id))\n\n    # Lock mutex and allow user to add to that poem with a session variable\n    mutex.update_record(editing = True, edit_timestamp = request.now, ping_timestamp = request.now)\n    session.allow_add = poem_id\n    redirect(URL(\'add\', args=poem_id))\n\ndef add_ping():\n    if request.vars.poem_id:\n        poem_id = request.vars.poem_id\n        mutex = db(db.mutex.poem_id == poem_id).select().first()\n        mutex.update_record(ping_timestamp = request.now)\n\ndef unlocked_mutex():\n    print \'trying to unlock...\'\n    if not request.args(0): redirect(URL(\'browse\'))\n    poem_id = request.args(0,cast=int)\n    mutex = db(db.mutex.poem_id == poem_id).select().first()\n    if request.vars.quit:\n        mutex.update_record(editing = False)\n        print \'unlocked mutex?\'\n\n@auth.requires_login()\ndef add():\n    import urllib\n    import urllib2\n    from gluon.contrib import simplejson\n\n    # Redirect to poem browser if no argument for poem id\n    if not request.args(0): redirect(URL(\'browse\'))\n\n    # Redirect if there was no add_check to verify that the user add at this time\n    if not session.allow_add == request.args(0,cast=int):\n        redirect(URL(\'browse\'))\n    else:\n        session.allow_add = None\n\n    # Load poem using the URL argument as poem id\n    poem = db.poem(request.args(0,cast=int))\n\n    # Add form for ABAB\n    if (poem.category == \'16 line ABAB rhyme\') or (poem.category == \'16 line AABB rhyme\') or (poem.category == \'Sonnet\') or (poem.category == \'Limerick\') or (poem.category == \'AAAA\'):\n        abab = db(db.abab.poem_id == poem.id).select().first()\n        lines = db(db.new_line.poem_id == poem.id).select(orderby=db.new_line.line_number)\n        if (poem.category == \'16 line ABAB rhyme\') or ((poem.category == \'Sonnet\') and (abab.line_count < 12)):\n        # Grab last word in the second to last line to rhyme by default (for ABAB rhyme scheme)\n            rhyme_word = \'\'\n            if abab.line_count == 2:\n                rhyme_word = abab.body.splitlines()[0].split(\' \')[-1]\n            elif abab.line_count == 3:\n                rhyme_word = abab.body.splitlines()[1].split(\' \')[-1]\n            else:\n                rhyme_line = db((db.new_line.poem_id == poem.id) & (db.new_line.line_number == abab.line_count-1)).select().first()\n                rhyme_word = rhyme_line.line.split(\' \')[-1]\n        elif (poem.category == \'Sonnet\') and (abab.line_count > 11):\n            rhyme_word = \'\'\n            rhyme_line = db((db.new_line.poem_id == poem.id) & (db.new_line.line_number == abab.line_count)).select().first()\n            rhyme_word = rhyme_line.line.split(\' \')[-1]\n        elif (poem.category == \'16 line AABB rhyme\') or ((poem.category == \'Limerick\') and (abab.line_count+1 < 5)):\n            rhyme_word = \'\'\n            if abab.line_count == 2:\n                rhyme_word = \'\'\n            else:\n                rhyme_line = db((db.new_line.poem_id == poem.id) & (db.new_line.line_number == abab.line_count)).select().first()\n                rhyme_word = rhyme_line.line.split(\' \')[-1]\n        elif (poem.category == \'Limerick\') and (abab.line_count+1 > 4):\n            rhyme_word = \'\'\n            rhyme_word = abab.body.splitlines()[0].split(\' \')[-1]\n        elif poem.category == \'AAAA\':\n            rhyme_word = \'\'\n            if abab.line_count == 2:\n                rhyme_word = abab.body.splitlines()[1].split(\' \')[-1]\n            else:\n                rhyme_word = \'\'\n                rhyme_line = db((db.new_line.poem_id == poem.id) & (db.new_line.line_number == abab.line_count)).select().first()\n                rhyme_word = rhyme_line.line.split(\' \')[-1]\n        #Get use the rhymebrain API\n        url = \'http://rhymebrain.com/talk\'\n        data = {}\n        data[\'function\'] = \'getRhymes\'\n        data[\'word\'] = rhyme_word\n        url_values = urllib.urlencode(data)\n        full_url = url + \'?\' + url_values\n        data = urllib2.urlopen(full_url)\n        result = data.read()\n        parsed_json = simplejson.loads(result)\n\n        sorted_syllables = [[] for x in range(11)]\n        for entry in parsed_json:\n            syllable_count = int(entry[\'syllables\'])\n            word = str(entry[\'word\'].encode(\'utf-8\',"ignore"))\n            sorted_syllables[syllable_count].append(word)\n\n        # Create SQLFORM for the user to add a single line as a String\n        form = SQLFORM(db.new_line, fields=[\'line\'])\n        form.vars.poem_id = poem.id\n        form.vars.line_number = abab.line_count + 1\n\n        form.process()\n        if form.accepted:\n            abab.update_record(line_count = abab.line_count + 1)\n            mutex = db(db.mutex.poem_id == poem.id).select().first()\n            mutex.update_record(editing = False)\n            redirect(URL(\'poem\', args=poem.id))\n    # Add form for Acrostic\n    elif (poem.category == \'Acrostic\'):\n        acrostic = db(db.acrostic.poem_id == poem.id).select().first()\n        lines = db(db.new_line.poem_id == poem.id).select(orderby=db.new_line.line_number)\n        # Create SQLFORM for the user to add a single line as a String\n        form = SQLFORM(db.new_line, fields=[\'line\'])\n        form.vars.poem_id = poem.id\n        form.vars.line_number = acrostic.line_count + 1\n\n        form.process(onvalidation = add_acrostic_check)\n        if form.accepted:\n            acrostic.update_record(line_count = acrostic.line_count + 1)\n            mutex = db(db.mutex.poem_id == poem.id).select().first()\n            mutex.update_record(editing = False)\n            redirect(URL(\'poem\', args=poem.id))\n    # Add form for Haiku\n    elif(poem.category == \'Haiku\') or (poem.category == \'10 line Syllabic Verse\') :\n        haiku = db(db.haiku.poem_id == poem.id).select().first()\n        words = db(db.new_word.poem_id == poem.id).select(orderby=db.new_word.word_number)\n        form = SQLFORM(db.new_word, fields=[\'word\'])\n        form.vars.poem_id = poem.id\n        form.vars.word_number = haiku.word_count + 1\n        syllables_left = 0\n        if poem.category == \'Haiku\':\n            if haiku.syllable_count < 5:\n                form.vars.line_count = 1\n                syllables_left = 5 - haiku.syllable_count\n            elif 5 <= haiku.syllable_count <=11:\n                form.vars.line_count = 2\n                syllables_left = 12 - haiku.syllable_count\n            elif 11 < haiku.syllable_count:\n                form.vars.line_count = 3\n                syllables_left = 17 - haiku.syllable_count\n            form.process(onvalidation = add_haiku_check)\n        elif poem.category == \'10 line Syllabic Verse\':\n            if haiku.syllable_count < 3:\n                form.vars.line_count = 2\n                syllables_left = 3 - haiku.syllable_count\n            elif 3 <= haiku.syllable_count <=5:\n                form.vars.line_count = 3\n                syllables_left = 6 - haiku.syllable_count\n            elif 5 < haiku.syllable_count <= 9:\n                form.vars.line_count = 4\n                syllables_left = 10 - haiku.syllable_count\n            elif 9 < haiku.syllable_count <= 14:\n                form.vars.line_count = 5\n                syllables_left = 15 - haiku.syllable_count\n            elif 14 < haiku.syllable_count <= 20:\n                form.vars.line_count = 6\n                syllables_left = 21 - haiku.syllable_count\n            elif 20 < haiku.syllable_count <= 27:\n                form.vars.line_count = 7\n                syllables_left = 28 - haiku.syllable_count\n            elif 27 < haiku.syllable_count <= 35:\n                form.vars.line_count = 8\n                syllables_left = 36 - haiku.syllable_count\n            elif 35 < haiku.syllable_count <= 44:\n                form.vars.line_count = 9\n                syllables_left = 45 - haiku.syllable_count\n            elif 44 < haiku.syllable_count:\n                form.vars.line_count = 10\n                syllables_left = 55 - haiku.syllable_count\n            form.process(onvalidation = add_syllabic_check)\n\n        if form.accepted:\n            syllable_count = count_syllables(form.vars.word)\n            db.new_word(form.vars.id).update_record(syllables = syllable_count)\n            haiku.update_record(word_count = haiku.word_count + 1, syllable_count = haiku.syllable_count + syllable_count)\n            mutex = db(db.mutex.poem_id == poem.id).select().first()\n            mutex.update_record(editing=False)\n            redirect(URL(\'poem\', args=poem.id))\n\n    return locals()\n\ndef add_haiku_check(form):\n    haiku = db(db.haiku.poem_id == form.vars.poem_id).select().first()\n\n    syllables_left = 0\n    if haiku.syllable_count < 5:\n        syllables_left = 5 - haiku.syllable_count\n    elif 5 <= haiku.syllable_count <=11:\n        syllables_left = 12 - haiku.syllable_count\n    elif 11 < haiku.syllable_count:\n        syllables_left = 17 - haiku.syllable_count\n\n    if count_syllables(form.vars.word) > syllables_left:\n        form.errors.word = \'Word has too many syllables for this line\'\n\ndef add_syllabic_check(form):\n    haiku = db(db.haiku.poem_id == form.vars.poem_id).select().first()\n\n    syllables_left = 0\n    if haiku.syllable_count < 3:\n        syllables_left = 3 - haiku.syllable_count\n    elif 3 <= haiku.syllable_count <= 5:\n        syllables_left = 6 - haiku.syllable_count\n    elif 5 < haiku.syllable_count <= 9:\n        syllables_left = 10 - haiku.syllable_count\n    elif 9 < haiku.syllable_count <= 14:\n        syllables_left = 15 - haiku.syllable_count\n    elif 14 < haiku.syllable_count <= 20:\n        syllables_left = 21 - haiku.syllable_count\n    elif 20 < haiku.syllable_count <= 27:\n        syllables_left = 28 - haiku.syllable_count\n    elif 27 < haiku.syllable_count <= 35:\n        syllables_left = 36 - haiku.syllable_count\n    elif 35 < haiku.syllable_count <= 44:\n        syllables_left = 45 - haiku.syllable_count\n    elif 44 < haiku.syllable_count:\n        syllables_left = 55 - haiku.syllable_count\n    if count_syllables(form.vars.word) > syllables_left:\n        form.errors.word = \'Word has too many syllables for this line\'\n\ndef add_acrostic_check (form):\n    acrostic = db(db.acrostic.poem_id == form.vars.poem_id).select().first()\n    check_acrostic = list(acrostic.word)[acrostic.line_count]\n    if (check_acrostic.lower() != form.vars.line[0][0].lower()):\n        form.errors.line = \'Does not start with the right letter\'\n\n@auth.requires_login()\ndef specialadd():\n    import urllib\n    import urllib2\n    from gluon.contrib import simplejson\n\n    # Redirect to poem browser if no argument for poem id\n    if not request.args(0): redirect(URL(\'browse\'))\n    lineNumber = request.args(1,cast = int)\n    # Load poem using the URL argument as poem id\n    poem = db.poem(request.args(0,cast=int))\n    rows = db(db.new_line.poem_id == poem.id).select(orderby=db.new_line.line_number)\n    check = db((db.new_line.poem_id == poem.id) & (db.new_line.line_number == request.args(1))).select().first()\n    if check:\n        if not check.line == \'\':\n            redirect(URL(\'browse\'))\n    # Check if poem is private and if current user has proper permissions, redirect if no permission\n    if poem.permission == \'Private\':\n        print \'private\'\n        print db(db.permission.poem_id == poem.id).select().first().user_id\n        print auth.user.id\n        if not db((db.permission.poem_id == poem.id) & (db.permission.user_id == auth.user_id)).select():\n            session.flash = \'You do not have permission to add to this poem\'\n            redirect(URL(\'poem\', args=poem.id))\n\n    # Add form for ABAB\n    if (poem.category == \'16 line ABAB rhyme\') or (poem.category == \'16 line AABB rhyme\'):\n        abab = db(db.abab.poem_id == poem.id).select().first()\n        rows = db(db.new_line.poem_id == poem.id).select(orderby=db.new_line.line_number)\n        if poem.category == \'16 line ABAB rhyme\':\n            # Grab last word in the second to last line to rhyme by default (for ABAB rhyme scheme)\n            rhyme_word = \'\'\n            rhyme_line = db((db.new_line.poem_id == poem.id) & (db.new_line.line_number == lineNumber+2)).select().first()\n            test = False\n            if lineNumber-1 == 2:\n                rhyme_word = abab.body.splitlines()[0].split(\' \')[-1]\n            elif lineNumber-1 == 3:\n                rhyme_word = abab.body.splitlines()[1].split(\' \')[-1]\n            elif rhyme_line:\n                rhyme_word = rhyme_line.line.split(\' \')[-1]\n                test = True\n            else:\n                rhyme_line = db((db.new_line.poem_id == poem.id) & (db.new_line.line_number == lineNumber-2)).select().first()\n                rhyme_word = rhyme_line.line.split(\' \')[-1]\n\n        elif poem.category == \'16 line AABB rhyme\':\n            # Grab last word in the second to last line to rhyme by default (for ABAB rhyme scheme)\n            rhyme_word = \'\'\n            rhyme_line = db((db.new_line.poem_id == poem.id) & (db.new_line.line_number == lineNumber+1)).select().first()\n            test = False\n            if (lineNumber % 4 == 0) or (lineNumber % 4 == 2):\n                rhyme_line = db((db.new_line.poem_id == poem.id) & (db.new_line.line_number == lineNumber-1)).select().first()\n                rhyme_word = rhyme_line.line.split(\' \')[-1]\n            elif rhyme_line:\n                rhyme_word = rhyme_line.line.split(\' \')[-1]\n                test = True\n        #Get use the rhymebrain API\n        url = \'http://rhymebrain.com/talk\'\n        data = {}\n        data[\'function\'] = \'getRhymes\'\n        data[\'word\'] = rhyme_word\n        url_values = urllib.urlencode(data)\n        full_url = url + \'?\' + url_values\n        data = urllib2.urlopen(full_url)\n        result = data.read()\n        parsed_json = simplejson.loads(result)\n\n        sorted_syllables = [[] for x in range(11)]\n        for entry in parsed_json:\n            syllable_count = int(entry[\'syllables\'])\n            word = str(entry[\'word\'].encode(\'utf-8\',"ignore"))\n            sorted_syllables[syllable_count].append(word)\n\n        # Create SQLFORM for the user to add a single line as a String\n        form = FORM(INPUT(_name = "line"),\n               INPUT(_type="submit",_value = "Add"))\n        if form.accepts(request,session):\n            response.flash = form.vars.line\n            if rows:\n                update = db((db.new_line.line == \'\') & (db.new_line.line_number == request.args(1))).select().first()\n                update.update_record(line = form.vars.line)\n                update.update_record(author = auth.user.id)\n                redirect(URL(\'poem\', args=poem.id))\n\n    # Add form for Haiku\n    elif poem.category == \'Haiku\':\n        haiku = db(db.haiku.poem_id == poem.id).select().first()\n        words = db(db.new_word.poem_id == poem.id).select(orderby=db.new_word.word_number)\n        # Create SQLFORM for the user to add a single line as a String\n        form = FORM(INPUT(_name = "word"),\n               INPUT(_type="submit",_value = "Add"))\n        if form.accepts(request,session):\n            response.flash = form.vars.word\n            if words:\n                update = db((db.new_word.word == \'\') & (db.new_word.word_number == request.args(1))).select().first()\n                update.update_record(word = form.vars.word)\n                update.update_record(author = auth.user.id)\n                redirect(URL(\'poem\', args=poem.id))\n    return locals()\n\ndef pick():\n    return locals()\n\n@auth.requires_login()\ndef profile():\n    user = auth.user\n    poem = db.poem\n    poems_owned = db(db.poem.author == user.id).select()\n    poems_contributed = db((db.new_line.author == user.id) & (db.poem.id == db.new_line.poem_id)).select(groupby=db.poem.id)\n    return locals()\n\nresponse._vars=response._caller(poem)\n'
p7
sS'snapshot'
p8
(dp9
S'exception'
p10
(dp11
S'__module__'
p12
S"'sqlite3'"
p13
sS'__getslice__'
p14
S"<method-wrapper '__getslice__' of OperationalError object>"
p15
sS'__str__'
p16
S"<method-wrapper '__str__' of OperationalError object>"
p17
sS'__reduce__'
p18
S'<built-in method __reduce__ of OperationalError object>'
p19
sS'__dict__'
p20
S'{}'
p21
sS'__sizeof__'
p22
S'<built-in method __sizeof__ of OperationalError object>'
p23
sS'__weakref__'
p24
S'None'
p25
sS'__init__'
p26
S"<method-wrapper '__init__' of OperationalError object>"
p27
sS'__setattr__'
p28
S"<method-wrapper '__setattr__' of OperationalError object>"
p29
sS'__reduce_ex__'
p30
S'<built-in method __reduce_ex__ of OperationalError object>'
p31
sS'__new__'
p32
S'<built-in method __new__ of type object>'
p33
sS'__format__'
p34
S'<built-in method __format__ of OperationalError object>'
p35
sS'__class__'
p36
S"<class 'sqlite3.OperationalError'>"
p37
sS'__doc__'
p38
S'None'
p39
sS'__getitem__'
p40
S"<method-wrapper '__getitem__' of OperationalError object>"
p41
sS'__setstate__'
p42
S'<built-in method __setstate__ of OperationalError object>'
p43
sS'__getattribute__'
p44
S"<method-wrapper '__getattribute__' of OperationalError object>"
p45
sS'args'
p46
S"('no such table: rating',)"
p47
sS'__subclasshook__'
p48
S'<built-in method __subclasshook__ of type object>'
p49
sS'__unicode__'
p50
S'<built-in method __unicode__ of OperationalError object>'
p51
sS'__delattr__'
p52
S"<method-wrapper '__delattr__' of OperationalError object>"
p53
sS'__repr__'
p54
S"<method-wrapper '__repr__' of OperationalError object>"
p55
sS'__hash__'
p56
S"<method-wrapper '__hash__' of OperationalError object>"
p57
ssS'evalue'
p58
S'no such table: rating'
p59
sS'request'
p60
cgluon.html
XML_unpickle
p61
(S's\xb9]\x00\x00<div><table><tr><td style="font-weight:bold;vertical-align:top;">ajax</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">application</td><td style="vertical-align:top;">:</td><td><div>P2P</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">args</td><td style="vertical-align:top;">:</td><td><div><table><tr><td><div>73</div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">cid</td><td style="vertical-align:top;">:</td><td><div>None</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">client</td><td style="vertical-align:top;">:</td><td><div>127.0.0.1</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">controller</td><td style="vertical-align:top;">:</td><td><div>default</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">cookies</td><td style="vertical-align:top;">:</td><td><div><table><tr><td style="font-weight:bold;vertical-align:top;">session_id_admin</td><td style="vertical-align:top;">:</td><td><div>127.0.0.1-1780e1d9-31fa-43e6-8e26-d686c334e971<table><tr><td style="font-weight:bold;vertical-align:top;">comment</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">domain</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">expires</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">httponly</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">max-age</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">path</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">secure</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">version</td><td style="vertical-align:top;">:</td><td><div></div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_id_p2p</td><td style="vertical-align:top;">:</td><td><div>127.0.0.1-9b82b6ec-885e-4479-9c08-b19ba9457063<table><tr><td style="font-weight:bold;vertical-align:top;">comment</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">domain</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">expires</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">httponly</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">max-age</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">path</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">secure</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">version</td><td style="vertical-align:top;">:</td><td><div></div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_id_welcome</td><td style="vertical-align:top;">:</td><td><div>127.0.0.1-669af364-57d0-4b01-94d6-5433729b52d0<table><tr><td style="font-weight:bold;vertical-align:top;">comment</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">domain</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">expires</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">httponly</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">max-age</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">path</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">secure</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">version</td><td style="vertical-align:top;">:</td><td><div></div></td></tr></table></div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">env</td><td style="vertical-align:top;">:</td><td><div><table><tr><td style="font-weight:bold;vertical-align:top;">HTTP_ACCEPT</td><td style="vertical-align:top;">:</td><td><div>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">HTTP_ACCEPT_ENCODING</td><td style="vertical-align:top;">:</td><td><div>gzip, deflate, sdch</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">HTTP_ACCEPT_LANGUAGE</td><td style="vertical-align:top;">:</td><td><div>en-US,en;q=0.8</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">HTTP_CONNECTION</td><td style="vertical-align:top;">:</td><td><div>keep-alive</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">HTTP_COOKIE</td><td style="vertical-align:top;">:</td><td><div>session_id_welcome=127.0.0.1-669af364-57d0-4b01-94d6-5433729b52d0; session_id_admin=127.0.0.1-1780e1d9-31fa-43e6-8e26-d686c334e971; session_id_p2p=127.0.0.1-9b82b6ec-885e-4479-9c08-b19ba9457063</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">HTTP_HOST</td><td style="vertical-align:top;">:</td><td><div>127.0.0.1:8000</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">HTTP_REFERER</td><td style="vertical-align:top;">:</td><td><div>http://127.0.0.1:8000/P2P/default/browse</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">HTTP_UPGRADE_INSECURE_REQUESTS</td><td style="vertical-align:top;">:</td><td><div>1</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">HTTP_USER_AGENT</td><td style="vertical-align:top;">:</td><td><div>Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.87 Safari/537.36</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">PATH_INFO</td><td style="vertical-align:top;">:</td><td><div>/P2P/default/poem/73</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">QUERY_STRING</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">REMOTE_ADDR</td><td style="vertical-align:top;">:</td><td><div>127.0.0.1</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">REMOTE_PORT</td><td style="vertical-align:top;">:</td><td><div>51873</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">REQUEST_METHOD</td><td style="vertical-align:top;">:</td><td><div>GET</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">SCRIPT_NAME</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">SERVER_NAME</td><td style="vertical-align:top;">:</td><td><div>Kevin-PC</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">SERVER_PORT</td><td style="vertical-align:top;">:</td><td><div>8000</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">SERVER_PROTOCOL</td><td style="vertical-align:top;">:</td><td><div>HTTP/1.1</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">SERVER_SOFTWARE</td><td style="vertical-align:top;">:</td><td><div>Rocket 1.2.6</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">app_folders</td><td style="vertical-align:top;">:</td><td><div>set([&#x27;C:\\\\Users\\\\Kevin\\\\Desktop\\\\web2py\\\\applications\\\\admin\\\\&#x27;, &#x27;C:\\\\Users\\\\Kevin\\\\Desktop\\\\web2py\\\\applications\\\\P2P\\\\&#x27;, &#x27;C:\\\\Users\\\\Kevin\\\\Desktop\\\\web2py\\\\applications\\\\welcome\\\\&#x27;])</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">applications_parent</td><td style="vertical-align:top;">:</td><td><div>C:\\Users\\Kevin\\Desktop\\web2py</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">cmd_args</td><td style="vertical-align:top;">:</td><td><div><table></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">cmd_options</td><td style="vertical-align:top;">:</td><td><div>&lt;Values at 0x2ff2698: {&#x27;verbose&#x27;: False, &#x27;ip&#x27;: &#x27;127.0.0.1&#x27;, &#x27;debuglevel&#x27;: 30, &#x27;with_scheduler&#x27;: False, &#x27;ips&#x27;: [], &#x27;shutdown_timeout&#x27;: 5, &#x27;taskbar&#x27;: False, &#x27;with_coverage&#x27;: False, &#x27;scheduler_groups&#x27;: None, &#x27;port&#x27;: 8000, &#x27;maxthreads&#x27;: None, &#x27;softcron&#x27;: False, &#x27;server_name&#x27;: &#x27;Kevin-PC&#x27;, &#x27;bpython&#x27;: False, &#x27;nogui&#x27;: False, &#x27;pid_filename&#x27;: &#x27;httpserver.pid&#x27;, &#x27;print_errors&#x27;: False, &#x27;extcron&#x27;: False, &#x27;runcron&#x27;: False, &#x27;run_system_tests&#x27;: False, &#x27;test&#x27;: None, &#x27;folder&#x27;: &#x27;C:\\\\Users\\\\Kevin\\\\Desktop\\\\web2py&#x27;, &#x27;config&#x27;: &#x27;&#x27;, &#x27;minthreads&#x27;: None, &#x27;shell&#x27;: None, &#x27;run&#x27;: &#x27;&#x27;, &#x27;log_filename&#x27;: &#x27;httpserver.log&#x27;, &#x27;profiler_dir&#x27;: None, &#x27;args&#x27;: [&#x27;&#x27;], &#x27;socket_timeout&#x27;: 5, &#x27;ssl_ca_certificate&#x27;: None, &#x27;scheduler&#x27;: None, &#x27;interfaces&#x27;: None, &#x27;ssl_private_key&#x27;: &#x27;&#x27;, &#x27;gae&#x27;: None, &#x27;password&#x27;: &#x27;&lt;ask&gt;&#x27;, &#x27;request_queue_size&#x27;: 5, &#x27;ssl_certificate&#x27;: &#x27;&#x27;, &#x27;cronjob&#x27;: False, &#x27;numthreads&#x27;: None, &#x27;quiet&#x27;: False, &#x27;import_models&#x27;: False, &#x27;timeout&#x27;: 10, &#x27;plain&#x27;: False, &#x27;nobanner&#x27;: False}&gt;</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">db_sessions</td><td style="vertical-align:top;">:</td><td><div>set([])</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">debugging</td><td style="vertical-align:top;">:</td><td><div>True</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">gluon_parent</td><td style="vertical-align:top;">:</td><td><div>C:\\Users\\Kevin\\Desktop\\web2py</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">http_accept</td><td style="vertical-align:top;">:</td><td><div>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">http_accept_encoding</td><td style="vertical-align:top;">:</td><td><div>gzip, deflate, sdch</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">http_accept_language</td><td style="vertical-align:top;">:</td><td><div>en-US,en;q=0.8</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">http_connection</td><td style="vertical-align:top;">:</td><td><div>keep-alive</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">http_cookie</td><td style="vertical-align:top;">:</td><td><div>session_id_welcome=127.0.0.1-669af364-57d0-4b01-94d6-5433729b52d0; session_id_admin=127.0.0.1-1780e1d9-31fa-43e6-8e26-d686c334e971; session_id_p2p=127.0.0.1-9b82b6ec-885e-4479-9c08-b19ba9457063</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">http_host</td><td style="vertical-align:top;">:</td><td><div>127.0.0.1:8000</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">http_referer</td><td style="vertical-align:top;">:</td><td><div>http://127.0.0.1:8000/P2P/default/browse</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">http_upgrade_insecure_requests</td><td style="vertical-align:top;">:</td><td><div>1</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">http_user_agent</td><td style="vertical-align:top;">:</td><td><div>Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.87 Safari/537.36</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">is_jython</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">is_pypy</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">is_source</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">local_hosts</td><td style="vertical-align:top;">:</td><td><div><table><tr><td><div>Kevin-PC.ucsc.edu</div></td></tr><tr><td><div>fe80::2c4e:8b33:8b54:6b8d%12</div></td></tr><tr><td><div>fe80::200:5efe:169.233.9.189%17</div></td></tr><tr><td><div>Kevin-PC</div></td></tr><tr><td><div>2002:a9e9:9bd::a9e9:9bd</div></td></tr><tr><td><div>::ffff:127.0.0.1</div></td></tr><tr><td><div>::1</div></td></tr><tr><td><div>169.233.9.189</div></td></tr><tr><td><div>127.0.0.1</div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">path_info</td><td style="vertical-align:top;">:</td><td><div>/P2P/default/poem/73</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">query_string</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">remote_addr</td><td style="vertical-align:top;">:</td><td><div>127.0.0.1</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">remote_port</td><td style="vertical-align:top;">:</td><td><div>51873</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">request_method</td><td style="vertical-align:top;">:</td><td><div>GET</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">request_uri</td><td style="vertical-align:top;">:</td><td><div>/P2P/default/poem/73</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">script_name</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">server_name</td><td style="vertical-align:top;">:</td><td><div>Kevin-PC</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">server_port</td><td style="vertical-align:top;">:</td><td><div>8000</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">server_protocol</td><td style="vertical-align:top;">:</td><td><div>HTTP/1.1</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">server_software</td><td style="vertical-align:top;">:</td><td><div>Rocket 1.2.6</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">web2py_path</td><td style="vertical-align:top;">:</td><td><div>C:\\Users\\Kevin\\Desktop\\web2py</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">web2py_version</td><td style="vertical-align:top;">:</td><td><div>2.13.4-stable+timestamp.2015.12.26.04.59.39</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi.errors</td><td style="vertical-align:top;">:</td><td><div>&lt;open file &#x27;&lt;stderr&gt;&#x27;, mode &#x27;w&#x27; at 0x01C6D0D0&gt;</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi.file_wrapper</td><td style="vertical-align:top;">:</td><td><div>&lt;class wsgiref.util.FileWrapper at 0x030362D0&gt;</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi.input</td><td style="vertical-align:top;">:</td><td><div>&lt;socket._fileobject object at 0x03C45770&gt;</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi.multiprocess</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi.multithread</td><td style="vertical-align:top;">:</td><td><div>True</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi.run_once</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi.url_scheme</td><td style="vertical-align:top;">:</td><td><div>http</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi.version</td><td style="vertical-align:top;">:</td><td><div><table><tr><td><div>1</div></td></tr><tr><td><div>0</div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi_errors</td><td style="vertical-align:top;">:</td><td><div>&lt;open file &#x27;&lt;stderr&gt;&#x27;, mode &#x27;w&#x27; at 0x01C6D0D0&gt;</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi_file_wrapper</td><td style="vertical-align:top;">:</td><td><div>&lt;class wsgiref.util.FileWrapper at 0x030362D0&gt;</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi_input</td><td style="vertical-align:top;">:</td><td><div>&lt;socket._fileobject object at 0x03C45770&gt;</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi_multiprocess</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi_multithread</td><td style="vertical-align:top;">:</td><td><div>True</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi_run_once</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi_url_scheme</td><td style="vertical-align:top;">:</td><td><div>http</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi_version</td><td style="vertical-align:top;">:</td><td><div><table><tr><td><div>1</div></td></tr><tr><td><div>0</div></td></tr></table></div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">extension</td><td style="vertical-align:top;">:</td><td><div>html</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">folder</td><td style="vertical-align:top;">:</td><td><div>C:\\Users\\Kevin\\Desktop\\web2py\\applications\\P2P\\</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">function</td><td style="vertical-align:top;">:</td><td><div>poem</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">global_settings</td><td style="vertical-align:top;">:</td><td><div><table><tr><td style="font-weight:bold;vertical-align:top;">app_folders</td><td style="vertical-align:top;">:</td><td><div>set([&#x27;C:\\\\Users\\\\Kevin\\\\Desktop\\\\web2py\\\\applications\\\\admin\\\\&#x27;, &#x27;C:\\\\Users\\\\Kevin\\\\Desktop\\\\web2py\\\\applications\\\\P2P\\\\&#x27;, &#x27;C:\\\\Users\\\\Kevin\\\\Desktop\\\\web2py\\\\applications\\\\welcome\\\\&#x27;])</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">applications_parent</td><td style="vertical-align:top;">:</td><td><div>C:\\Users\\Kevin\\Desktop\\web2py</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">cmd_args</td><td style="vertical-align:top;">:</td><td><div><table></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">cmd_options</td><td style="vertical-align:top;">:</td><td><div>&lt;Values at 0x2ff2698: {&#x27;verbose&#x27;: False, &#x27;ip&#x27;: &#x27;127.0.0.1&#x27;, &#x27;debuglevel&#x27;: 30, &#x27;with_scheduler&#x27;: False, &#x27;ips&#x27;: [], &#x27;shutdown_timeout&#x27;: 5, &#x27;taskbar&#x27;: False, &#x27;with_coverage&#x27;: False, &#x27;scheduler_groups&#x27;: None, &#x27;port&#x27;: 8000, &#x27;maxthreads&#x27;: None, &#x27;softcron&#x27;: False, &#x27;server_name&#x27;: &#x27;Kevin-PC&#x27;, &#x27;bpython&#x27;: False, &#x27;nogui&#x27;: False, &#x27;pid_filename&#x27;: &#x27;httpserver.pid&#x27;, &#x27;print_errors&#x27;: False, &#x27;extcron&#x27;: False, &#x27;runcron&#x27;: False, &#x27;run_system_tests&#x27;: False, &#x27;test&#x27;: None, &#x27;folder&#x27;: &#x27;C:\\\\Users\\\\Kevin\\\\Desktop\\\\web2py&#x27;, &#x27;config&#x27;: &#x27;&#x27;, &#x27;minthreads&#x27;: None, &#x27;shell&#x27;: None, &#x27;run&#x27;: &#x27;&#x27;, &#x27;log_filename&#x27;: &#x27;httpserver.log&#x27;, &#x27;profiler_dir&#x27;: None, &#x27;args&#x27;: [&#x27;&#x27;], &#x27;socket_timeout&#x27;: 5, &#x27;ssl_ca_certificate&#x27;: None, &#x27;scheduler&#x27;: None, &#x27;interfaces&#x27;: None, &#x27;ssl_private_key&#x27;: &#x27;&#x27;, &#x27;gae&#x27;: None, &#x27;password&#x27;: &#x27;&lt;ask&gt;&#x27;, &#x27;request_queue_size&#x27;: 5, &#x27;ssl_certificate&#x27;: &#x27;&#x27;, &#x27;cronjob&#x27;: False, &#x27;numthreads&#x27;: None, &#x27;quiet&#x27;: False, &#x27;import_models&#x27;: False, &#x27;timeout&#x27;: 10, &#x27;plain&#x27;: False, &#x27;nobanner&#x27;: False}&gt;</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">db_sessions</td><td style="vertical-align:top;">:</td><td><div>set([])</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">debugging</td><td style="vertical-align:top;">:</td><td><div>True</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">gluon_parent</td><td style="vertical-align:top;">:</td><td><div>C:\\Users\\Kevin\\Desktop\\web2py</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">is_jython</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">is_pypy</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">is_source</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">local_hosts</td><td style="vertical-align:top;">:</td><td><div><table><tr><td><div>Kevin-PC.ucsc.edu</div></td></tr><tr><td><div>fe80::2c4e:8b33:8b54:6b8d%12</div></td></tr><tr><td><div>fe80::200:5efe:169.233.9.189%17</div></td></tr><tr><td><div>Kevin-PC</div></td></tr><tr><td><div>2002:a9e9:9bd::a9e9:9bd</div></td></tr><tr><td><div>::ffff:127.0.0.1</div></td></tr><tr><td><div>::1</div></td></tr><tr><td><div>169.233.9.189</div></td></tr><tr><td><div>127.0.0.1</div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">web2py_version</td><td style="vertical-align:top;">:</td><td><div>2.13.4-stable+timestamp.2015.12.26.04.59.39</div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">is_https</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">is_local</td><td style="vertical-align:top;">:</td><td><div>True</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">is_restful</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">is_scheduler</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">is_shell</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">now</td><td style="vertical-align:top;">:</td><td><div>datetime.datetime(2016, 3, 15, 2, 55, 15, 87000)</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">raw_args</td><td style="vertical-align:top;">:</td><td><div>73</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">raw_extension</td><td style="vertical-align:top;">:</td><td><div>None</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">url</td><td style="vertical-align:top;">:</td><td><div>/P2P/default/poem/73</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">utcnow</td><td style="vertical-align:top;">:</td><td><div>datetime.datetime(2016, 3, 15, 9, 55, 15, 88000)</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">wsgi</td><td style="vertical-align:top;">:</td><td><div>&lt;gluon.main.LazyWSGI object at 0x083541F0&gt;</div></td></tr></table></div>'
tRp62
sS'frames'
p63
(lp64
(dp65
S'file'
p66
S'C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\restricted.py'
p67
sS'dump'
p68
(dp69
S'environment'
p70
S"{'A': <class 'gluon.html.A'>, 'ANY_OF': <class 'gluon.validators.ANY_OF'>, 'ASSIGNJS': <function ASSIGNJS>, 'AppConfig': <function AppConfig>, 'Auth': <class 'gluon.tools.Auth'>, 'B': <class 'gluon.html.B'>, 'BEAUTIFY': <class 'gluon.html.BEAUTIFY'>, 'BODY': <class 'gluon.html.BODY'>, 'BR': <class 'gluon.html.BR'>, 'BUTTON': <class 'gluon.html.BUTTON'>, ...}"
p71
sS'ccode'
p72
S'<code object <module> at 083274E8, file "C:\\User...pplications\\P2P\\controllers/default.py", line 10>'
p73
ssS'lnum'
p74
I227
sS'lines'
p75
(dp76
I224
S'            ccode = code'
p77
sI225
S'        else:'
p78
sI226
S'            ccode = compile2(code, layer)'
p79
sI227
S'        exec ccode in environment'
p80
sI228
S'    except HTTP:'
p81
sI229
S'        raise'
p82
sI230
S'    except RestrictedError:'
p83
sI231
S'        # do not encapsulate (obfuscate) the original RestrictedError'
p84
sI222
S'    try:'
p85
sI223
S'        if isinstance(code, types.CodeType):'
p86
ssS'call'
p87
S"(code='# -*- coding: utf-8 -*-\\n# this file is released ... locals()\\n\\nresponse._vars=response._caller(poem)\\n', environment={'A': <class 'gluon.html.A'>, 'ANY_OF': <class 'gluon.validators.ANY_OF'>, 'ASSIGNJS': <function ASSIGNJS>, 'AppConfig': <function AppConfig>, 'Auth': <class 'gluon.tools.Auth'>, 'B': <class 'gluon.html.B'>, 'BEAUTIFY': <class 'gluon.html.BEAUTIFY'>, 'BODY': <class 'gluon.html.BODY'>, 'BR': <class 'gluon.html.BR'>, 'BUTTON': <class 'gluon.html.BUTTON'>, ...}, layer=r'C:\\Users\\Kevin\\Desktop\\web2py\\applications\\P2P\\controllers/default.py')"
p88
sS'func'
p89
S'restricted'
p90
sa(dp91
g66
S'C:\\Users\\Kevin\\Desktop\\web2py\\applications\\P2P\\controllers\\default.py'
p92
sg68
(dp93
sg74
I638
sg75
(dp94
I627
S'def pick():'
p95
sI628
S'    return locals()'
p96
sI629
S''
sI630
S'@auth.requires_login()'
p97
sI631
S'def profile():'
p98
sI632
S'    user = auth.user'
p99
sI633
S'    poem = db.poem'
p100
sI634
S'    poems_owned = db(db.poem.author == user.id).select()'
p101
sI635
S'    poems_contributed = db((db.new_line.author == user.id) & (db.poem.id == db.new_line.poem_id)).select(groupby=db.poem.id)'
p102
sI636
S'    return locals()'
p103
ssg87
S'()'
p104
sg89
S'<module>'
p105
sa(dp106
g66
S'C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\globals.py'
p107
sg68
(dp108
S'self'
p109
S'undefined'
p110
sS'f'
S'<function poem>'
p111
ssg74
I412
sg75
(dp112
I416
S"        self.generic_patterns = ['*']"
p113
sI407
S"        self.flash = ''            # used by the default view layout"
p114
sI408
S'        self.meta = Storage()      # used by web2py_ajax.html'
p115
sI409
S'        self.menu = []             # used by the default view layout'
p116
sI410
S'        self.files = []            # used by web2py_ajax.html'
p117
sI411
S'        self._vars = None'
p118
sI412
S'        self._caller = lambda f: f()'
p119
sI413
S'        self._view_environment = None'
p120
sI414
S'        self._custom_commit = None'
p121
sI415
S'        self._custom_rollback = None'
p122
ssg87
S'(f=<function poem>)'
p123
sg89
S'<lambda>'
p124
sa(dp125
g66
S'C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\tools.py'
p126
sg68
(dp127
S'action'
p128
S'<function poem>'
p129
sS'a'
S'()'
p130
sS'b'
g21
ssg74
I4236
sg75
(dp131
I4231
S'                    flag = condition'
p132
sI4232
S'                if not flag:'
p133
sI4233
S'                    current.session.flash = self.messages.access_denied'
p134
sI4234
S'                    return call_or_redirect('
p135
sI4235
S'                        self.settings.on_failed_authorization)'
p136
sI4236
S'                return action(*a, **b)'
p137
sI4237
S'            f.__doc__ = action.__doc__'
p138
sI4238
S'            f.__name__ = action.__name__'
p139
sI4239
S'            f.__dict__.update(action.__dict__)'
p140
sI4240
S'            return f'
p141
ssg87
S'(*a=(), **b={})'
p142
sg89
S'f'
sa(dp143
g66
S'C:\\Users\\Kevin\\Desktop\\web2py\\applications\\P2P\\controllers\\default.py'
p144
sg68
(dp145
S'rating'
p146
g110
sS'db.rating.poem_id'
p147
S'<pydal.objects.Field object>'
p148
sS'poem'
p149
S"<Row {'abab': <Set (abab.poem_id = 73)>, 'rating...sted': datetime.datetime(2016, 3, 15, 2, 44, 1)}>"
p150
sS').select'
p151
g110
sS'global db'
p152
S'<DAL uri="sqlite://storage.sqlite">'
p153
sS'db.rating'
p154
S'<Table rating (id,poem_id,author,voteFunny,voteInteresting,voteCool)>'
p155
sS'poem.id'
p156
S'73L'
p157
ssg74
I44
sg75
(dp158
I39
S'    # Redirect to poem browser if no argument for poem id'
p159
sI40
S"    if not request.args(0): redirect(URL('browse'))"
p160
sI41
S''
sI42
S'    # Load poem using the URL argument as poem id'
p161
sI43
S'    poem = db.poem(request.args(0,cast=int))'
p162
sI44
S'    rating = db(db.rating.poem_id == poem.id).select()'
p163
sI45
S'    # Displaying ABAB'
p164
sI46
S"    if (poem.category == '16 line ABAB rhyme') or (poem.category == '16 line AABB rhyme') or (poem.category == 'Sonnet') or (poem.category == 'Limerick') or (poem.category == 'AAAA'):"
p165
sI47
S'        abab = db(db.abab.poem_id == poem.id).select().first()'
p166
sI48
S'        lines = db(db.new_line.poem_id == poem.id).select(orderby=db.new_line.line_number)'
p167
ssg87
S'()'
p168
sg89
S'poem'
p169
sa(dp170
g66
S'C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\packages\\dal\\pydal\\objects.py'
p171
sg68
(dp172
S'self.query'
p173
S'<Query (rating.poem_id = 73)>'
p174
sS'adapter.select'
p175
S'<bound method SQLiteAdapter.select of <pydal.adapters.sqlite.SQLiteAdapter object>>'
p176
sS'fields'
p177
S'[<pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>]'
p178
sS'adapter'
p179
S'<pydal.adapters.sqlite.SQLiteAdapter object>'
p180
sS'attributes'
p181
g21
sS'self'
p182
S'<Set (rating.poem_id = 73)>'
p183
ssg74
I2025
sg75
(dp184
I2020
S"                                    attributes.get('join',None),"
p185
sI2021
S"                                    attributes.get('left',None),"
p186
sI2022
S"                                    attributes.get('orderby',None),"
p187
sI2023
S"                                    attributes.get('groupby',None))"
p188
sI2024
S'        fields = adapter.expand_all(fields, tablenames)'
p189
sI2025
S'        return adapter.select(self.query,fields,attributes)'
p190
sI2026
S''
sI2027
S'    def iterselect(self, *fields, **attributes):'
p191
sI2028
S'        adapter = self.db._adapter'
p192
sI2029
S'        tablenames = adapter.tables(self.query,'
p193
ssg87
S'(self=<Set (rating.poem_id = 73)>, *fields=[<pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>], **attributes={})'
p194
sg89
S'select'
p195
sa(dp196
g66
S'C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\packages\\dal\\pydal\\adapters\\sqlite.py'
p197
sg68
(dp198
S'fields'
p199
S'[<pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>]'
p200
sS'self'
p201
S'<pydal.adapters.sqlite.SQLiteAdapter object>'
p202
sS').select'
p203
S'<bound method SQLiteAdapter.select of <pydal.adapters.sqlite.SQLiteAdapter object>>'
p204
sS'attributes'
p205
g21
sS'global SQLiteAdapter'
p206
S"<class 'pydal.adapters.sqlite.SQLiteAdapter'>"
p207
sS'query'
p208
S'<Query (rating.poem_id = 73)>'
p209
sS'builtinsuper'
p210
S"<type 'super'>"
p211
ssg74
I124
sg75
(dp212
I128
S"    'Windows':'mod_spatialite.dll',"
p213
sI119
S'        Note that the entire database, rather than one record, is locked'
p214
sI120
S'        (it will be locked eventually anyway by the following UPDATE).'
p215
sI121
S'        """'
p216
sI122
S"        if attributes.get('for_update', False) and not 'cache' in attributes:"
p217
sI123
S"            self.execute('BEGIN IMMEDIATE TRANSACTION;')"
p218
sI124
S'        return super(SQLiteAdapter, self).select(query, fields, attributes)'
p219
sI125
S''
sI126
S''
sI127
S'SPATIALLIBS = {'
p220
ssg87
S'(self=<pydal.adapters.sqlite.SQLiteAdapter object>, query=<Query (rating.poem_id = 73)>, fields=[<pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>], attributes={})'
p221
sg89
g195
sa(dp222
g66
S'C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\packages\\dal\\pydal\\adapters\\base.py'
p223
sg68
(dp224
S'fields'
p225
S'[<pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>]'
p226
sS'self'
p227
S'<pydal.adapters.sqlite.SQLiteAdapter object>'
p228
sS'attributes'
p229
g21
sS'self._select_aux'
p230
S'<bound method SQLiteAdapter._select_aux of <pydal.adapters.sqlite.SQLiteAdapter object>>'
p231
sS'sql'
p232
S"'SELECT  rating.id, rating.poem_id, rating.author...voteCool FROM rating WHERE (rating.poem_id = 73);'"
p233
ssg74
I1293
sg75
(dp234
I1288
S'            return cache_model('
p235
sI1289
S'                key,'
p236
sI1290
S'                lambda self=self,args=args:self._select_aux(*args),'
p237
sI1291
S'                time_expire)'
p238
sI1292
S'        else:'
p239
sI1293
S'            return self._select_aux(sql,fields,attributes)'
p240
sI1294
S''
sI1295
S'    def iterselect(self, query, fields, attributes):'
p241
sI1296
S'        sql = self._select(query, fields, attributes)'
p242
sI1297
S"        cacheable = attributes.get('cacheable', False)"
p243
ssg87
S'(self=<pydal.adapters.sqlite.SQLiteAdapter object>, query=<Query (rating.poem_id = 73)>, fields=[<pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>], attributes={})'
p244
sg89
g195
sa(dp245
g66
S'C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\packages\\dal\\pydal\\adapters\\base.py'
p246
sg68
(dp247
S'self'
p248
S'<pydal.adapters.sqlite.SQLiteAdapter object>'
p249
sS'self.execute'
p250
S'<bound method SQLiteAdapter.execute of <pydal.adapters.sqlite.SQLiteAdapter object>>'
p251
sS'sql'
p252
S"'SELECT  rating.id, rating.poem_id, rating.author...voteCool FROM rating WHERE (rating.poem_id = 73);'"
p253
ssg74
I1250
sg75
(dp254
I1248
S"        cache = args_get('cache',None)"
p255
sI1249
S'        if not cache:'
p256
sI1250
S'            self.execute(sql)'
p257
sI1251
S'            rows = self._fetchall()'
p258
sI1252
S'        else:'
p259
sI1253
S'            if isinstance(cache, dict):'
p260
sI1254
S"                cache_model = cache['model']"
p261
sI1245
S''
sI1246
S'    def _select_aux(self, sql, fields, attributes):'
p262
sI1247
S'        args_get = attributes.get'
p263
ssg87
S"(self=<pydal.adapters.sqlite.SQLiteAdapter object>, sql='SELECT  rating.id, rating.poem_id, rating.author...voteCool FROM rating WHERE (rating.poem_id = 73);', fields=[<pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>, <pydal.objects.Field object>], attributes={})"
p264
sg89
S'_select_aux'
p265
sa(dp266
g66
S'C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\packages\\dal\\pydal\\adapters\\base.py'
p267
sg68
(dp268
S'a'
S"('SELECT  rating.id, rating.poem_id, rating.author...voteCool FROM rating WHERE (rating.poem_id = 73);',)"
p269
sS'self'
p270
S'<pydal.adapters.sqlite.SQLiteAdapter object>'
p271
sS'b'
g21
sS'self.log_execute'
p272
S'<bound method SQLiteAdapter.log_execute of <pydal.adapters.sqlite.SQLiteAdapter object>>'
p273
ssg74
I1385
sg75
(dp274
I1380
S'        self.db._timings.append((command,time.time()-t0))'
p275
sI1381
S'        del self.db._timings[:-TIMINGSSIZE]'
p276
sI1382
S'        return ret'
p277
sI1383
S''
sI1384
S'    def execute(self, *a, **b):'
p278
sI1385
S'        return self.log_execute(*a, **b)'
p279
sI1386
S''
sI1387
S'    def execute_test_query(self):'
p280
sI1388
S'        return self.execute(self.test_query)'
p281
sI1389
S''
ssg87
S"(self=<pydal.adapters.sqlite.SQLiteAdapter object>, *a=('SELECT  rating.id, rating.poem_id, rating.author...voteCool FROM rating WHERE (rating.poem_id = 73);',), **b={})"
p282
sg89
S'execute'
p283
sa(dp284
g66
S'C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\packages\\dal\\pydal\\adapters\\base.py'
p285
sg68
(dp286
S'a'
S"('SELECT  rating.id, rating.poem_id, rating.author...voteCool FROM rating WHERE (rating.poem_id = 73);',)"
p287
sS'b'
g21
sS'self'
p288
S'<pydal.adapters.sqlite.SQLiteAdapter object>'
p289
sS'ret'
p290
g110
sS'command'
p291
S"'SELECT  rating.id, rating.poem_id, rating.author...voteCool FROM rating WHERE (rating.poem_id = 73);'"
p292
sS'self.get_cursor'
p293
S'<bound method SQLiteAdapter.get_cursor of <pydal.adapters.sqlite.SQLiteAdapter object>>'
p294
sS').execute'
p295
g110
ssg74
I1379
sg75
(dp296
I1376
S"            self.db.logger.debug('SQL: %s' % command)"
p297
sI1377
S'        self.db._lastsql = command'
p298
sI1378
S'        t0 = time.time()'
p299
sI1379
S'        ret = self.get_cursor().execute(command, *a[1:], **b)'
p300
sI1380
S'        self.db._timings.append((command,time.time()-t0))'
p301
sI1381
S'        del self.db._timings[:-TIMINGSSIZE]'
p302
sI1382
S'        return ret'
p303
sI1383
S''
sI1374
S'            command = self.filter_sql_command(command)'
p304
sI1375
S'        if self.db._debug:'
p305
ssg87
S"(self=<pydal.adapters.sqlite.SQLiteAdapter object>, *a=('SELECT  rating.id, rating.poem_id, rating.author...voteCool FROM rating WHERE (rating.poem_id = 73);',), **b={})"
p306
sg89
S'log_execute'
p307
sasS'pyver'
p308
S'Python 2.7.9: C:\\Users\\Kevin\\Desktop\\web2py\\web2py.exe (prefix: )'
p309
sS'session'
p310
g61
(S's\x90\n\x00\x00<div><table><tr><td style="font-weight:bold;vertical-align:top;">auth</td><td style="vertical-align:top;">:</td><td><div><table><tr><td style="font-weight:bold;vertical-align:top;">expiration</td><td style="vertical-align:top;">:</td><td><div>3600</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">hmac_key</td><td style="vertical-align:top;">:</td><td><div>4b3032b6-d2bc-4dcc-b959-e25456fa4931</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">last_visit</td><td style="vertical-align:top;">:</td><td><div>datetime.datetime(2016, 3, 15, 2, 52, 34, 428000)</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">remember_me</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">user</td><td style="vertical-align:top;">:</td><td><div><table><tr><td style="font-weight:bold;vertical-align:top;">email</td><td style="vertical-align:top;">:</td><td><div>default@email.com</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">first_name</td><td style="vertical-align:top;">:</td><td><div>default</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">id</td><td style="vertical-align:top;">:</td><td><div>4L</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">last_name</td><td style="vertical-align:top;">:</td><td><div>default</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">registration_id</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">registration_key</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">reset_password_key</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">username</td><td style="vertical-align:top;">:</td><td><div>default</div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">user_groups</td><td style="vertical-align:top;">:</td><td><div><table><tr><td style="font-weight:bold;vertical-align:top;">4</td><td style="vertical-align:top;">:</td><td><div>user_4</div></td></tr></table></div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">flash</td><td style="vertical-align:top;">:</td><td><div>None</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">last_orderby</td><td style="vertical-align:top;">:</td><td><div>None</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">last_query</td><td style="vertical-align:top;">:</td><td><div>db.rating.id&gt;0</div></td></tr></table></div>'
tRp311
sS'etype'
p312
S"<class 'sqlite3.OperationalError'>"
p313
sS'date'
p314
S'Tue Mar 15 02:55:15 2016'
p315
sS'response'
p316
g61
(S'sP)\x00\x00<div><table><tr><td style="font-weight:bold;vertical-align:top;">body</td><td style="vertical-align:top;">:</td><td><div>&lt;cStringIO.StringO object at 0x088C4240&gt;</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">cookies</td><td style="vertical-align:top;">:</td><td><div><table><tr><td style="font-weight:bold;vertical-align:top;">session_id_p2p</td><td style="vertical-align:top;">:</td><td><div>127.0.0.1-9b82b6ec-885e-4479-9c08-b19ba9457063<table><tr><td style="font-weight:bold;vertical-align:top;">comment</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">domain</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">expires</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">httponly</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">max-age</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">path</td><td style="vertical-align:top;">:</td><td><div>/</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">secure</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">version</td><td style="vertical-align:top;">:</td><td><div></div></td></tr></table></div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">delimiters</td><td style="vertical-align:top;">:</td><td><div><table><tr><td><div>{{</div></td></tr><tr><td><div>}}</div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">files</td><td style="vertical-align:top;">:</td><td><div><table></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">flash</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">form_label_separator</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">formstyle</td><td style="vertical-align:top;">:</td><td><div>bootstrap3_inline</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">generic_patterns</td><td style="vertical-align:top;">:</td><td><div><table><tr><td><div>*</div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">google_analytics_id</td><td style="vertical-align:top;">:</td><td><div>None</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">headers</td><td style="vertical-align:top;">:</td><td><div><table><tr><td style="font-weight:bold;vertical-align:top;">X-Powered-By</td><td style="vertical-align:top;">:</td><td><div>web2py</div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">logo</td><td style="vertical-align:top;">:</td><td><div><a class="navbar-brand" id="web2py-logo"><b><span>P</span><span>2</span><span>P</span></b></a></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">menu</td><td style="vertical-align:top;">:</td><td><div><table><tr><td><div><table><tr><td><div>Home</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/P2P/default/index</div></td></tr><tr><td><div><table></table></div></td></tr></table></div></td></tr><tr><td><div><table><tr><td><div>Browse Poems</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/P2P/default/browse</div></td></tr><tr><td><div><table></table></div></td></tr></table></div></td></tr><tr><td><div><table><tr><td><div>Search Poems</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/P2P/default/search</div></td></tr><tr><td><div><table></table></div></td></tr></table></div></td></tr><tr><td><div><table><tr><td><div>Profile</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/P2P/default/profile</div></td></tr><tr><td><div><table></table></div></td></tr></table></div></td></tr><tr><td><div><table><tr><td><div>My Sites</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/admin/default/site</div></td></tr></table></div></td></tr><tr><td><div><table><tr><td><div>This App</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>#</div></td></tr><tr><td><div><table><tr><td><div><table><tr><td><div>Design</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/admin/default/design/P2P</div></td></tr></table></div></td></tr><tr><td><div><li class="divider"></li></div></td></tr><tr><td><div><table><tr><td><div>Controller</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/admin/default/edit/P2P/controllers/default.py</div></td></tr></table></div></td></tr><tr><td><div><table><tr><td><div>View</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/admin/default/edit/P2P/views/default/poem.html</div></td></tr></table></div></td></tr><tr><td><div><table><tr><td><div>DB Model</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/admin/default/edit/P2P/models/db.py</div></td></tr></table></div></td></tr><tr><td><div><table><tr><td><div>Menu Model</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/admin/default/edit/P2P/models/menu.py</div></td></tr></table></div></td></tr><tr><td><div><table><tr><td><div>Config.ini</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/admin/default/edit/P2P/private/appconfig.ini</div></td></tr></table></div></td></tr><tr><td><div><table><tr><td><div>Layout</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/admin/default/edit/P2P/views/layout.html</div></td></tr></table></div></td></tr><tr><td><div><table><tr><td><div>Stylesheet</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/admin/default/edit/P2P/static/css/web2py-bootstrap3.css</div></td></tr></table></div></td></tr><tr><td><div><table><tr><td><div>Database</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/P2P/appadmin/index</div></td></tr></table></div></td></tr><tr><td><div><table><tr><td><div>Errors</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/admin/default/errors/P2P</div></td></tr></table></div></td></tr><tr><td><div><table><tr><td><div>About</div></td></tr><tr><td><div>False</div></td></tr><tr><td><div>/admin/default/about/P2P</div></td></tr></table></div></td></tr></table></div></td></tr></table></div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">meta</td><td style="vertical-align:top;">:</td><td><div><table><tr><td style="font-weight:bold;vertical-align:top;">author</td><td style="vertical-align:top;">:</td><td><div>Your Name &lt;you@example.com&gt;</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">description</td><td style="vertical-align:top;">:</td><td><div>a cool new app</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">generator</td><td style="vertical-align:top;">:</td><td><div>Web2py Web Framework</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">keywords</td><td style="vertical-align:top;">:</td><td><div>web2py, python, framework</div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">models_to_run</td><td style="vertical-align:top;">:</td><td><div><table><tr><td><div>^\\w+\\.py$</div></td></tr><tr><td><div>^default/\\w+\\.py$</div></td></tr><tr><td><div>^default/poem/\\w+\\.py$</div></td></tr></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">postprocessing</td><td style="vertical-align:top;">:</td><td><div><table></table></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_client</td><td style="vertical-align:top;">:</td><td><div>127.0.0.1</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_cookie_compression_level</td><td style="vertical-align:top;">:</td><td><div>None</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_cookie_expires</td><td style="vertical-align:top;">:</td><td><div>None</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_cookie_key</td><td style="vertical-align:top;">:</td><td><div>None</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_data_name</td><td style="vertical-align:top;">:</td><td><div>session_data_p2p</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_file</td><td style="vertical-align:top;">:</td><td><div>&lt;open file &#x27;C:\\\\Users\\\\Kevin\\\\Desktop\\\\web2py\\\\applications\\\\P2P\\\\sessions\\\\15e\\\\1a3\\\\127.0.0.1-9b82b6ec-885e-4479-9c08-b19ba9457063&#x27;, mode &#x27;rb+&#x27; at 0x085113E8&gt;</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_filename</td><td style="vertical-align:top;">:</td><td><div>C:\\Users\\Kevin\\Desktop\\web2py\\applications\\P2P\\sessions\\127.0.0.1-9b82b6ec-885e-4479-9c08-b19ba9457063</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_hash</td><td style="vertical-align:top;">:</td><td><div>7cc5bcb1ec91572922f78ad7b32b5fbe</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_id</td><td style="vertical-align:top;">:</td><td><div>127.0.0.1-9b82b6ec-885e-4479-9c08-b19ba9457063</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_id_name</td><td style="vertical-align:top;">:</td><td><div>session_id_p2p</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_locked</td><td style="vertical-align:top;">:</td><td><div>True</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_masterapp</td><td style="vertical-align:top;">:</td><td><div>P2P</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_new</td><td style="vertical-align:top;">:</td><td><div>False</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">session_storage_type</td><td style="vertical-align:top;">:</td><td><div>file</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">status</td><td style="vertical-align:top;">:</td><td><div>200</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">subtitle</td><td style="vertical-align:top;">:</td><td><div></div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">title</td><td style="vertical-align:top;">:</td><td><div>P2P</div></td></tr><tr><td style="font-weight:bold;vertical-align:top;">view</td><td style="vertical-align:top;">:</td><td><div>default/poem.html</div></td></tr></table></div>'
tRp317
sS'locals'
p318
(dp319
S'a'
S"('SELECT  rating.id, rating.poem_id, rating.author...voteCool FROM rating WHERE (rating.poem_id = 73);',)"
p320
sS'self'
p321
S'<pydal.adapters.sqlite.SQLiteAdapter object>'
p322
sS'b'
g21
sS'command'
p323
S"'SELECT  rating.id, rating.poem_id, rating.author...voteCool FROM rating WHERE (rating.poem_id = 73);'"
p324
sS't0'
p325
S'1458035715.243'
p326
sssS'traceback'
p327
S'Traceback (most recent call last):\n  File "C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\restricted.py", line 227, in restricted\n    exec ccode in environment\n  File "C:\\Users\\Kevin\\Desktop\\web2py\\applications\\P2P\\controllers/default.py", line 638, in <module>\n  File "C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\globals.py", line 412, in <lambda>\n    self._caller = lambda f: f()\n  File "C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\tools.py", line 4236, in f\n    return action(*a, **b)\n  File "C:\\Users\\Kevin\\Desktop\\web2py\\applications\\P2P\\controllers/default.py", line 44, in poem\n    rating = db(db.rating.poem_id == poem.id).select()\n  File "C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\packages\\dal\\pydal\\objects.py", line 2025, in select\n    return adapter.select(self.query,fields,attributes)\n  File "C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\packages\\dal\\pydal\\adapters\\sqlite.py", line 124, in select\n    return super(SQLiteAdapter, self).select(query, fields, attributes)\n  File "C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\packages\\dal\\pydal\\adapters\\base.py", line 1293, in select\n    return self._select_aux(sql,fields,attributes)\n  File "C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\packages\\dal\\pydal\\adapters\\base.py", line 1250, in _select_aux\n    self.execute(sql)\n  File "C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\packages\\dal\\pydal\\adapters\\base.py", line 1385, in execute\n    return self.log_execute(*a, **b)\n  File "C:\\Users\\Kevin\\Desktop\\web2py\\gluon\\packages\\dal\\pydal\\adapters\\base.py", line 1379, in log_execute\n    ret = self.get_cursor().execute(command, *a[1:], **b)\nOperationalError: no such table: rating\n'
p328
s.